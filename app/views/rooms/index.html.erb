<%# app/views/rooms/index.html.erb %>

<%# ===============================
   検索フォーム（フル幅・header直下）
=============================== %>
<% content_for :full_width do %>
  <div class="search-nav">
    <div class="search-nav-inner">
      <%= form_with url: rooms_path, method: :get, local: true do |f| %>
        <div class="form-row d-flex align-items-center">
          <%# エリア検索 %>
          <div class="form-group mr-3">
            <%= f.select :area,
              options_for_select(
                [["東京", "東京"], ["大阪", "大阪"], ["京都", "京都"], ["札幌", "札幌"]],
                params[:area]
              ),
              include_blank: "すべて"
            %>
          </div>

          <%# フリーワード検索 %>
          <div class="form-group mr-3">
            <%= f.text_field :keyword,
              value: params[:keyword],
              placeholder: "施設名・詳細を検索"
            %>
          </div>

          <div class="form-group">
            <%= f.submit "検索", class: "btn btn-primary" %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
<% end %>

<%# ===============================
   メインコンテンツ（通常幅）
=============================== %>
<div class="rooms-index">
  <h1>
    <% if params[:area].present? || params[:keyword].present? %>
      検索結果：<%= @rooms.count %>件が見つかりました
    <% else %>
      部屋一覧
    <% end %>
  </h1>

  <ul class="rooms list-unstyled">
    <% @rooms.each do |room| %>
      <li class="room-card">
        <%# 画像表示 %>
        <% if room.image.attached? %>
          <%= image_tag url_for(room.image), class: "room-image" %>
        <% else %>
          <%= image_tag "default_room.png", class: "room-image" %>
        <% end %>

        <%# 施設情報 %>
        <div class="room-info">
          <h3><%= room.name %></h3>

          <p class="room-address text-muted small"><%= room.address %></p>

          <% if room.description.present? %>
            <p class="small mb-2"><%= truncate(room.description, length: 60) %></p>
          <% end %>

          <p class="room-price"><%= number_to_currency(room.price) %>〜 / 泊</p>

          <%= link_to "詳細を見る", room_path(room), class: "btn btn-outline-primary btn-sm mt-2" %>
        </div>
      </li>
    <% end %>
  </ul>

  <% if @rooms.empty? %>
    <p>条件に一致する施設がありません</p>
  <% end %>
</div>

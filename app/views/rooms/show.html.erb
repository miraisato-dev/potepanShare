<div data-controller="room-reservation">
  <h1><%= @room.name %></h1>

  <%= link_to "部屋一覧に戻る", rooms_path, class: "btn btn-secondary" %>

  <% if current_user %>
    <h2>予約する</h2>

    <% if @room.image.attached? %>
      <%= image_tag @room.image, class: "room-image-large" %>
    <% else %>
      <%= image_tag "default_room.png", class: "room-image-large" %>
    <% end %>
    
    <%= form_with model: Reservation.new,
          url: confirm_room_reservations_path(@room),
          local: true,
          data: { turbo: false } do |f| %>

      <p>
        <strong>チェックイン：</strong>
        <!-- type="text" にする dateにするとturboで動かない-->
        <%= f.text_field :start_date,
        id: "start_date",
        autocomplete: "off",
        placeholder: "yyyy/mm/dd" %>
      </p>

      <p>
        <strong>チェックアウト：</strong>
        <%= f.text_field :end_date,
        id: "end_date",
        autocomplete: "off",
        placeholder: "yyyy/mm/dd" %>
      </p>

      <%= f.submit "予約する", class: "btn btn-primary" %>
    <% end %>

    <!-- 予約済み日データ -->
    <div id="booked-dates" data-dates="<%= @room.booked_dates.map(&:to_s).join(',') %>"></div>
  <% else %>
    <%= link_to "ログインして予約", login_path, class: "btn btn-warning" %>
  <% end %>
</div>
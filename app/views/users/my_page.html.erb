<%# app/views/users/my_page.html.erb %>
 <div class="page-container">
    <h1>マイページ</h1>
    
    <h2>プロフィール・アカウント情報編集</h2>
    <%= form_with(model: @user, url: update_account_path, method: :patch, local: true, multipart: true) do |f| %>
      <div>
        <%= f.label :name %>
        <%= f.text_field :name %>
      </div>
    
      <div>
        <%= f.label :email %>
        <%= f.email_field :email %>
      </div>
    
      <div>
        <%= f.label :password %>
        <%= f.password_field :password, autocomplete: "new-password" %>
        <small>変更する場合のみ入力</small>
      </div>
    
      <div>
        <%= f.label :password_confirmation %>
        <%= f.password_field :password_confirmation %>
      </div>
    
      <div>
        <%= f.label :bio, "自己紹介" %>
        <%= f.text_area :bio %>
      </div>
    
      <div>
        <%= f.label :avatar, "アイコン画像" %>
        <%= f.file_field :avatar %>
        <% if @user.avatar.attached? %>
          <div>
            <%= image_tag @user.avatar.variant(resize_to_limit: [100, 100]) %>
          </div>
        <% end %>
      </div>
    
      <div>
        <%= f.submit "更新" %>
      </div>
    <% end %>
    
    <hr>
    
    <h2>マイ予約一覧</h2>
    <% if @reservations.any? %>
      <% @reservations.each do |reservation| %>
        <div class="card mb-3 p-3">
          <h3>
            <%= link_to reservation.room.name, room_path(reservation.room) %>
          </h3>
    
          <p>
            <strong>チェックイン：</strong>
            <%= reservation.start_date.strftime("%Y/%m/%d") %><br>
            <strong>チェックアウト：</strong>
            <%= reservation.end_date.strftime("%Y/%m/%d") %>
          </p>
    
          <p>
            <strong>宿泊日数：</strong>
            <%= (reservation.end_date - reservation.start_date).to_i %> 泊
          </p>
    
          <p>
            <strong>合計料金：</strong>
            <%= number_to_currency(reservation.total_price) %>
          </p>
    
          <%= link_to "キャンセル",
              room_reservation_path(reservation.room, reservation),
              data: { turbo_method: :delete, turbo_confirm: "本当にキャンセルしますか？" },
              class: "btn btn-danger btn-sm" %>
        </div>
      <% end %>
    <% else %>
      <p>予約はまだありません。</p>
    <% end %>
</div>